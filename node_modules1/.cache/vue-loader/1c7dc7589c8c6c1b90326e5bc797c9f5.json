{"remainingRequest":"F:\\Projects\\fanexus\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\Projects\\fanexus\\src\\components\\Community\\CommunityMembers.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\Projects\\fanexus\\src\\components\\Community\\CommunityMembers.vue","mtime":1598358775290},{"path":"F:\\Projects\\fanexus\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Projects\\fanexus\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\Projects\\fanexus\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Projects\\fanexus\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBtYXBTdGF0ZSB9IGZyb20gJ3Z1ZXgnOw0KaW1wb3J0IHsNCiAgY29tbXVuaXR5QXJlYXMsDQogIGdldE1lbWJlcnMsDQogIHJlbW92ZU1lbWJlckZyb21Db21tdW5pdHksDQogIGFkZE1vZGVyYXRvcnMNCn0gZnJvbSAnQC9zZXJ2aWNlcy9Db21tdW5pdHkvY29tbXVuaXR5LnNlcnZpY2UnOw0KaW1wb3J0IEdyb3VwQ29tcG9uZW50IGZyb20gJ0AvY29tcG9uZW50cy9CbG9nL0dyb3VwQ29tcG9uZW50JzsNCmltcG9ydCBUYWJDb250ZW50R3JpZCBmcm9tICcuLi9jb21tb24vVGFiQ29udGVudEdyaWQnOw0KaW1wb3J0IENvbmZpcm1hdGlvbk1vZGFsIGZyb20gJy4uL2NvbW1vbi9Db25maXJtYXRpb25Nb2RhbCc7DQppbXBvcnQgeyBkZWxldGVJdGVtQnlJZCB9IGZyb20gJ0AvdXRpbHMvYXJyYXknOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6IGNvbW11bml0eUFyZWFzLm1lbWJlcnMsDQogIGNvbXBvbmVudHM6IHsNCiAgICBHcm91cENvbXBvbmVudCwNCiAgICBUYWJDb250ZW50R3JpZCwNCiAgICBDb25maXJtYXRpb25Nb2RhbA0KICB9LA0KICBwcm9wczogew0KICAgIGRhdGE6IHsNCiAgICAgIHR5cGU6IE9iamVjdCwNCiAgICAgIHJlcXVpcmVkOiB0cnVlDQogICAgfSwNCiAgICBjb21tdW5pdHlJZDogew0KICAgICAgdHlwZTogW051bWJlciwgU3RyaW5nXSwNCiAgICAgIHJlcXVpcmVkOiB0cnVlDQogICAgfQ0KICB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICAvKkBUT0RPIHJldmlzZSovDQogICAgICBncm91cHM6IFtdLA0KICAgICAgYWN0aXZlSXRlbTogbnVsbCwNCiAgICAgIHNldHRpbmdzOiB7DQogICAgICAgIHNob3c6IGZhbHNlLA0KICAgICAgICB0aXRsZTogJ0RlbGV0ZSBtZW1iZXInLA0KICAgICAgICAvKiogQFRPRE8gbWFrZSAnQ2FuY2VsJyBhIGRlZmF1bHQgZGlzbWlzc1RleHQgICovDQogICAgICAgIHJlbW92ZWRJdGVtOiAndXNlcicsDQogICAgICAgIHJlbW92ZWRGcm9tOiAnbWVtYmVycycsDQogICAgICAgIGRpc21pc3NUZXh0OiAnQ2FuY2VsJywNCiAgICAgICAgYWN0aW9uVGV4dDogJ0RlbGV0ZScsDQogICAgICAgIGRhdGE6IFtdDQogICAgICB9LA0KICAgICAgZHJvcGRvd25PcHRpb25zTWVtYmVyczogWw0KICAgICAgICB7DQogICAgICAgICAgdGV4dDogJ0RlbGV0ZSBtZW1iZXInLA0KICAgICAgICAgIGFjdGlvbjogJ2RlbGV0ZScsDQogICAgICAgICAgc3BlY2lhbDogdHJ1ZSwNCiAgICAgICAgICB0b2dnbGFibGU6IGZhbHNlDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICB0ZXh0OiAnQWRkIHVzZXIgYXMgbW9kZXJhdG9yJywNCiAgICAgICAgICBhY3Rpb246ICdhZGQnLA0KICAgICAgICAgIHNwZWNpYWw6IGZhbHNlLA0KICAgICAgICAgIHRvZ2dsYWJsZTogZmFsc2UNCiAgICAgICAgfQ0KICAgICAgXQ0KICAgIH07DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBoYW5kbGVNb2RhbE9wZW4oKSB7DQogICAgICAvKiogQFRPRE8gbWFrZSBpdCBjb21tb24gKi8NCiAgICAgIHRoaXMuJGVtaXQoJ29wZW5Nb2RhbCcpOw0KICAgIH0sDQogICAgc2hvd01vZGFsKGlkKSB7DQogICAgICB0aGlzLmFjdGl2ZUl0ZW0gPSBpZDsNCiAgICAgIHRoaXMuc2V0dGluZ3Muc2hvdyA9IHRydWU7DQogICAgfSwNCiAgICByZW1vdmVJdGVtRnJvbUFycmF5KCkgew0KICAgICAgZGVsZXRlSXRlbUJ5SWQodGhpcy5hY3RpdmVJdGVtLCB0aGlzLmdyb3VwcywgKCkgPT4gew0KICAgICAgICB0aGlzLmFjdGl2ZUl0ZW0gPSBudWxsOw0KICAgICAgfSk7DQogICAgfSwNCiAgICBhc3luYyBkZWxldGVNZW1iZXIoKSB7DQogICAgICBjb25zdCBwYXlsb2FkID0gew0KICAgICAgICBhbGlhczogdGhpcy5hY3RpdmVBbGlhc0lkLA0KICAgICAgICByZW1vdmVNZW1iZXJJZDogdGhpcy5hY3RpdmVJdGVtDQogICAgICB9Ow0KICAgICAgdHJ5IHsNCiAgICAgICAgYXdhaXQgcmVtb3ZlTWVtYmVyRnJvbUNvbW11bml0eSh0aGlzLmNvbW11bml0eUlkLCBwYXlsb2FkKTsNCiAgICAgICAgdGhpcy5yZW1vdmVJdGVtRnJvbUFycmF5KCk7DQogICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGFzeW5jIGFkZFVzZXJBc01vZGVyYXRvcihpZCkgew0KICAgICAgaWYgKGlkKSB7DQogICAgICAgIGNvbnN0IHBheWxvYWQgPSB7DQogICAgICAgICAgYWxpYXM6IHRoaXMuYWN0aXZlQWxpYXNJZCwNCiAgICAgICAgICBtb2RlcmF0b3JzOiBbaWRdDQogICAgICAgIH07DQogICAgICAgIHRyeSB7DQogICAgICAgICAgYXdhaXQgYWRkTW9kZXJhdG9ycyh0aGlzLmNvbW11bml0eUlkLCBwYXlsb2FkKTsNCiAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0sDQogICAgYXN5bmMgZ2V0RGF0YShmaWx0ZXJCeSkgew0KICAgICAgdGhpcy5ncm91cHMgPSBhd2FpdCBnZXRNZW1iZXJzKHRoaXMuY29tbXVuaXR5SWQsIDEsIGZpbHRlckJ5KTsNCiAgICB9LA0KICAgIGFzeW5jIGhhbmRsZUlucHV0KGlucHV0KSB7DQogICAgICBhd2FpdCB0aGlzLmdldERhdGEoaW5wdXQpOw0KICAgIH0NCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICAuLi5tYXBTdGF0ZSh7DQogICAgICBhY3RpdmVBbGlhc0lkOiBzdGF0ZSA9PiBzdGF0ZS5hbGlhcy5hY3RpdmVBbGlhc0lkDQogICAgfSkNCiAgfSwNCiAgYXN5bmMgbW91bnRlZCgpIHsNCiAgICBhd2FpdCB0aGlzLmdldERhdGEoKTsNCiAgfQ0KfTsNCg=="},{"version":3,"sources":["CommunityMembers.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CommunityMembers.vue","sourceRoot":"src/components/Community","sourcesContent":["<template>\r\n  <section class=\"members\">\r\n    <tab-content-grid\r\n      :showSearch=\"true\"\r\n      btnSecondary=\"Invite members\"\r\n      btnPrimary=\"Delete members\"\r\n      title=\"Members\"\r\n      @handleSecondaryBtn=\"handleModalOpen\"\r\n      @handle-input=\"handleInput\"\r\n    >\r\n      <template v-if=\"groups\">\r\n        <group-component\r\n          group-component-type=\"blog\"\r\n          :link=\"link\"\r\n          :isAddingUser=\"true\"\r\n          @add=\"addUserAsModerator\"\r\n          v-for=\"({ id, name, avatar, updatedAt, Blog: { link } },\r\n          index) in groups\"\r\n          :key=\"`${id}-${index}`\"\r\n          :id=\"id\"\r\n          :name=\"name\"\r\n          :image=\"avatar ? avatar.src : ''\"\r\n          activityName=\"Updated at:\"\r\n          :date=\"updatedAt\"\r\n          :userHasEditPermissions=\"data && data.userHasEditPermissions\"\r\n          @delete=\"showModal(id)\"\r\n          :options=\"dropdownOptionsMembers\"\r\n        />\r\n        <confirmation-modal\r\n          @submit=\"deleteMember\"\r\n          v-if=\"settings.show\"\r\n          :settings=\"settings\"\r\n        />\r\n      </template>\r\n    </tab-content-grid>\r\n  </section>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from 'vuex';\r\nimport {\r\n  communityAreas,\r\n  getMembers,\r\n  removeMemberFromCommunity,\r\n  addModerators\r\n} from '@/services/Community/community.service';\r\nimport GroupComponent from '@/components/Blog/GroupComponent';\r\nimport TabContentGrid from '../common/TabContentGrid';\r\nimport ConfirmationModal from '../common/ConfirmationModal';\r\nimport { deleteItemById } from '@/utils/array';\r\n\r\nexport default {\r\n  name: communityAreas.members,\r\n  components: {\r\n    GroupComponent,\r\n    TabContentGrid,\r\n    ConfirmationModal\r\n  },\r\n  props: {\r\n    data: {\r\n      type: Object,\r\n      required: true\r\n    },\r\n    communityId: {\r\n      type: [Number, String],\r\n      required: true\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      /*@TODO revise*/\r\n      groups: [],\r\n      activeItem: null,\r\n      settings: {\r\n        show: false,\r\n        title: 'Delete member',\r\n        /** @TODO make 'Cancel' a default dismissText  */\r\n        removedItem: 'user',\r\n        removedFrom: 'members',\r\n        dismissText: 'Cancel',\r\n        actionText: 'Delete',\r\n        data: []\r\n      },\r\n      dropdownOptionsMembers: [\r\n        {\r\n          text: 'Delete member',\r\n          action: 'delete',\r\n          special: true,\r\n          togglable: false\r\n        },\r\n        {\r\n          text: 'Add user as moderator',\r\n          action: 'add',\r\n          special: false,\r\n          togglable: false\r\n        }\r\n      ]\r\n    };\r\n  },\r\n  methods: {\r\n    handleModalOpen() {\r\n      /** @TODO make it common */\r\n      this.$emit('openModal');\r\n    },\r\n    showModal(id) {\r\n      this.activeItem = id;\r\n      this.settings.show = true;\r\n    },\r\n    removeItemFromArray() {\r\n      deleteItemById(this.activeItem, this.groups, () => {\r\n        this.activeItem = null;\r\n      });\r\n    },\r\n    async deleteMember() {\r\n      const payload = {\r\n        alias: this.activeAliasId,\r\n        removeMemberId: this.activeItem\r\n      };\r\n      try {\r\n        await removeMemberFromCommunity(this.communityId, payload);\r\n        this.removeItemFromArray();\r\n      } catch (e) {\r\n        return false;\r\n      }\r\n    },\r\n    async addUserAsModerator(id) {\r\n      if (id) {\r\n        const payload = {\r\n          alias: this.activeAliasId,\r\n          moderators: [id]\r\n        };\r\n        try {\r\n          await addModerators(this.communityId, payload);\r\n        } catch (e) {\r\n          return false;\r\n        }\r\n      }\r\n    },\r\n    async getData(filterBy) {\r\n      this.groups = await getMembers(this.communityId, 1, filterBy);\r\n    },\r\n    async handleInput(input) {\r\n      await this.getData(input);\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState({\r\n      activeAliasId: state => state.alias.activeAliasId\r\n    })\r\n  },\r\n  async mounted() {\r\n    await this.getData();\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped></style>\r\n"]}]}