{"remainingRequest":"F:\\Projects\\fanexus\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\Projects\\fanexus\\src\\views\\TagEdit.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\Projects\\fanexus\\src\\views\\TagEdit.vue","mtime":1595221465094},{"path":"F:\\Projects\\fanexus\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Projects\\fanexus\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\Projects\\fanexus\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Projects\\fanexus\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBnZXRUYWcsIGNyZWF0ZVRhZywgZWRpdFRhZyB9IGZyb20gJ0Avc2VydmljZXMvdGFnLnNlcnZpY2UnOw0KaW1wb3J0IEZvcm1CdXR0b24gZnJvbSAnfmNvbW1vbi9CdXR0b25zL0Zvcm1CdXR0b24nOw0KaW1wb3J0IEZvcm1JbnB1dCBmcm9tICd+Y29tbW9uL0ZpZWxkcy9Gb3JtSW5wdXQnOw0KaW1wb3J0IFRhZ0lucHV0IGZyb20gJ35jb21tb24vRmllbGRzL1RhZ0lucHV0JzsNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBwcm9wczogew0KICAgIG5hbWU6IHsNCiAgICAgIHJlcXVpcmVkOiB0cnVlLA0KICAgICAgdHlwZTogW051bWJlciwgU3RyaW5nXQ0KICAgIH0NCiAgfSwNCiAgY29tcG9uZW50czogew0KICAgIEZvcm1CdXR0b24sDQogICAgRm9ybUlucHV0LA0KICAgIFRhZ0lucHV0DQogIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIG5ld1RhZzogZmFsc2UsDQogICAgICB0YWdOYW1lOiAnJywNCiAgICAgIGRlc2NyaXB0aW9uOiAnJywNCiAgICAgIHBhcmVudFRhZ0xpc3Q6IFtdLA0KICAgICAgY2hpbGRUYWdMaXN0OiBbXSwNCiAgICAgIHN5bm9ueW1zOiBbXQ0KICAgIH07DQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgdGFnRGF0YSgpIHsNCiAgICAgIHJldHVybiB7DQogICAgICAgIG5hbWU6IHRoaXMudGFnTmFtZSwNCiAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuZGVzY3JpcHRpb24sDQogICAgICAgIHBhcmVudFRhZ3M6IHRoaXMucGFyZW50VGFnTGlzdCwNCiAgICAgICAgY2hpbGRUYWdzOiB0aGlzLmNoaWxkVGFnTGlzdCwNCiAgICAgICAgc3lub255bXM6IHRoaXMuc3lub255bXMNCiAgICAgIH07DQogICAgfQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgdXBkYXRlTGlzdChsaXN0LCBuZXdMaXN0KSB7DQogICAgICB0aGlzW2xpc3RdID0gbmV3TGlzdDsNCiAgICB9LA0KICAgIGFzeW5jIGdldERhdGEoKSB7DQogICAgICB0cnkgew0KICAgICAgICBjb25zdCB0YWdEYXRhID0gYXdhaXQgdGhpcy5nZXRFeGFjdFRhZyh0aGlzLm5hbWUpOw0KICAgICAgICBpZiAodGFnRGF0YSkgew0KICAgICAgICAgIHRoaXMudGFnTmFtZSA9IHRhZ0RhdGEubmFtZTsNCiAgICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gdGFnRGF0YS5kZXNjcmlwdGlvbjsNCiAgICAgICAgICB0aGlzLnBhcmVudFRhZ0xpc3QgPSB0YWdEYXRhLnBhcmVudFRhZ3MubWFwKHRhZyA9PiB0YWcubmFtZSk7DQogICAgICAgICAgdGhpcy5jaGlsZFRhZ0xpc3QgPSB0YWdEYXRhLmNoaWxkVGFncy5tYXAodGFnID0+IHRhZy5uYW1lKTsNCiAgICAgICAgICB0aGlzLnN5bm9ueW1zID0gdGFnRGF0YS5zeW5vbnltczsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0aGlzLm5ld1RhZyA9IHRydWU7DQogICAgICAgICAgdGhpcy50YWdOYW1lID0gdGhpcy5uYW1lOw0KICAgICAgICB9DQogICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGFzeW5jIGdldEV4YWN0VGFnKHRhZ05hbWUpIHsNCiAgICAgIGNvbnN0IG1hdGNoZWRUYWdzID0gKGF3YWl0IGdldFRhZyh0YWdOYW1lKSkuZmlsdGVyKA0KICAgICAgICByZXN1bHQgPT4gcmVzdWx0Lm5hbWUgPT09IHRhZ05hbWUNCiAgICAgICk7DQogICAgICBpZiAobWF0Y2hlZFRhZ3MubGVuZ3RoKSB7DQogICAgICAgIHJldHVybiBtYXRjaGVkVGFnc1swXTsNCiAgICAgIH0NCiAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9LA0KICAgIGFzeW5jIGNyZWF0ZVRhZ0lmTm90RXhpc3QobmFtZSkgew0KICAgICAgY29uc3QgdGFnRGF0YSA9IGF3YWl0IHRoaXMuZ2V0RXhhY3RUYWcobmFtZSk7DQogICAgICBpZiAodGFnRGF0YSkgew0KICAgICAgICByZXR1cm4gdGFnRGF0YS5uYW1lOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgY29uc3QgcGF5bG9hZCA9IFtuYW1lXTsNCiAgICAgICAgY29uc3QgbmV3VGFnID0gYXdhaXQgY3JlYXRlVGFnKC4uLnBheWxvYWQpOw0KICAgICAgICByZXR1cm4gbmV3VGFnLm5hbWU7DQogICAgICB9DQogICAgfSwNCiAgICBhc3luYyBjcmVhdGVQYXJlbnRBbmRDaGlsZFRhZ3MoKSB7DQogICAgICBhd2FpdCBQcm9taXNlLmFsbCgNCiAgICAgICAgdGhpcy5wYXJlbnRUYWdMaXN0DQogICAgICAgICAgLm1hcCh0aGlzLmNyZWF0ZVRhZ0lmTm90RXhpc3QpDQogICAgICAgICAgLmNvbmNhdCh0aGlzLmNoaWxkVGFnTGlzdC5tYXAodGhpcy5jcmVhdGVUYWdJZk5vdEV4aXN0KSkNCiAgICAgICk7DQogICAgfSwNCiAgICBhc3luYyBzdWJtaXRUYWdFZGl0KCkgew0KICAgICAgYXdhaXQgdGhpcy5jcmVhdGVQYXJlbnRBbmRDaGlsZFRhZ3MoKTsNCiAgICAgIGNvbnN0IHBheWxvYWQgPSBbdGhpcy5uYW1lLCB0aGlzLnRhZ0RhdGFdOw0KICAgICAgaWYgKHRoaXMubmV3VGFnKSB7DQogICAgICAgIGF3YWl0IGNyZWF0ZVRhZyguLi5wYXlsb2FkKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGF3YWl0IGVkaXRUYWcoLi4ucGF5bG9hZCk7DQogICAgICB9DQogICAgfQ0KICB9LA0KICBhc3luYyBtb3VudGVkKCkgew0KICAgIGF3YWl0IHRoaXMuZ2V0RGF0YSgpOw0KICB9DQp9Ow0K"},{"version":3,"sources":["TagEdit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsDA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TagEdit.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"tag-edit\">\r\n    <form class=\"tag-edit__form\" @submit.prevent=\"submitTagEdit\" ref=\"form\">\r\n      <!-- @TODO fix input borders -->\r\n      <!-- add input labels, remove headers -->\r\n      <form-input\r\n        :notBordered=\"true\"\r\n        class=\"tag-edit__input\"\r\n        labelText=\"Tag name\"\r\n        name=\"tag-name\"\r\n        placeholder=\"Tag name\"\r\n        v-model=\"tagName\"\r\n      />\r\n      <form-input\r\n        :notBordered=\"true\"\r\n        class=\"tag-edit__input\"\r\n        labelText=\"Tag Description\"\r\n        name=\"tag-description\"\r\n        placeholder=\"Tag description\"\r\n        v-model=\"description\"\r\n      />\r\n      <h4 class=\"tag-edit__title\">Parent tags:</h4>\r\n      <tag-input\r\n        class=\"tag-edit__input\"\r\n        name=\"parent-tags\"\r\n        placeholder=\"Add parent tag\"\r\n        :list=\"parentTagList\"\r\n        @listChange=\"updateList('parentTagList', $event)\"\r\n      />\r\n      <h4 class=\"tag-edit__title\">Child tags:</h4>\r\n      <tag-input\r\n        class=\"tag-edit__input\"\r\n        name=\"child-tags\"\r\n        placeholder=\"Add child tag\"\r\n        :list=\"childTagList\"\r\n        @listChange=\"updateList('childTagList', $event)\"\r\n      />\r\n      <h4 class=\"tag-edit__title\">Synonym Tags:</h4>\r\n      <tag-input\r\n        class=\"tag-edit__input\"\r\n        name=\"synonyms\"\r\n        placeholder=\"Add synonym\"\r\n        :list=\"synonyms\"\r\n        @listChange=\"updateList('synonyms', $event)\"\r\n      />\r\n      <div class=\"tag-edit__buttons\">\r\n        <form-button class=\"tag-edit__cancel-btn\" type=\"reset\" text=\"Cancel\" />\r\n        <form-button class=\"tag-edit__save-btn\" type=\"submit\" text=\"Save\" />\r\n      </div>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getTag, createTag, editTag } from '@/services/tag.service';\r\nimport FormButton from '~common/Buttons/FormButton';\r\nimport FormInput from '~common/Fields/FormInput';\r\nimport TagInput from '~common/Fields/TagInput';\r\n\r\nexport default {\r\n  props: {\r\n    name: {\r\n      required: true,\r\n      type: [Number, String]\r\n    }\r\n  },\r\n  components: {\r\n    FormButton,\r\n    FormInput,\r\n    TagInput\r\n  },\r\n  data() {\r\n    return {\r\n      newTag: false,\r\n      tagName: '',\r\n      description: '',\r\n      parentTagList: [],\r\n      childTagList: [],\r\n      synonyms: []\r\n    };\r\n  },\r\n  computed: {\r\n    tagData() {\r\n      return {\r\n        name: this.tagName,\r\n        description: this.description,\r\n        parentTags: this.parentTagList,\r\n        childTags: this.childTagList,\r\n        synonyms: this.synonyms\r\n      };\r\n    }\r\n  },\r\n  methods: {\r\n    updateList(list, newList) {\r\n      this[list] = newList;\r\n    },\r\n    async getData() {\r\n      try {\r\n        const tagData = await this.getExactTag(this.name);\r\n        if (tagData) {\r\n          this.tagName = tagData.name;\r\n          this.description = tagData.description;\r\n          this.parentTagList = tagData.parentTags.map(tag => tag.name);\r\n          this.childTagList = tagData.childTags.map(tag => tag.name);\r\n          this.synonyms = tagData.synonyms;\r\n        } else {\r\n          this.newTag = true;\r\n          this.tagName = this.name;\r\n        }\r\n      } catch (e) {\r\n        return false;\r\n      }\r\n    },\r\n    async getExactTag(tagName) {\r\n      const matchedTags = (await getTag(tagName)).filter(\r\n        result => result.name === tagName\r\n      );\r\n      if (matchedTags.length) {\r\n        return matchedTags[0];\r\n      }\r\n      return false;\r\n    },\r\n    async createTagIfNotExist(name) {\r\n      const tagData = await this.getExactTag(name);\r\n      if (tagData) {\r\n        return tagData.name;\r\n      } else {\r\n        const payload = [name];\r\n        const newTag = await createTag(...payload);\r\n        return newTag.name;\r\n      }\r\n    },\r\n    async createParentAndChildTags() {\r\n      await Promise.all(\r\n        this.parentTagList\r\n          .map(this.createTagIfNotExist)\r\n          .concat(this.childTagList.map(this.createTagIfNotExist))\r\n      );\r\n    },\r\n    async submitTagEdit() {\r\n      await this.createParentAndChildTags();\r\n      const payload = [this.name, this.tagData];\r\n      if (this.newTag) {\r\n        await createTag(...payload);\r\n      } else {\r\n        await editTag(...payload);\r\n      }\r\n    }\r\n  },\r\n  async mounted() {\r\n    await this.getData();\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n/** @TODO revise styling */\r\n.tag-edit {\r\n  padding: var(--element-padding-xl);\r\n  width: 100%;\r\n  overflow-y: auto;\r\n  grid-area: content;\r\n\r\n  &__form {\r\n    max-width: var(--width-large);\r\n  }\r\n\r\n  h4 {\r\n    color: var(--text-primary);\r\n    margin-bottom: var(--element-margin-xs);\r\n  }\r\n\r\n  &__input {\r\n    margin-bottom: var(--element-margin-l);\r\n    display: inline-block;\r\n    border-radius: var(--border-radius);\r\n    width: 680px;\r\n  }\r\n\r\n  &__cancel-btn {\r\n    margin-right: var(--element-margin-m);\r\n    min-width: 90px;\r\n  }\r\n\r\n  &__save-btn {\r\n    min-width: 90px;\r\n  }\r\n\r\n  &__buttons {\r\n    border-top: var(--border-width-thin) solid var(--popular-blog-divider);\r\n    padding-top: var(--element-padding-l);\r\n  }\r\n\r\n  &__title {\r\n    font-size: var(--size-button);\r\n    font-family: 'OpenSans-Bold', sans-serif;\r\n    margin-bottom: var(--element-margin-s);\r\n    color: var(--text-primary);\r\n  }\r\n}\r\n\r\n::v-deep {\r\n  input {\r\n    background-color: var(--BG-blog-post);\r\n  }\r\n\r\n  .tags-input-area {\r\n    border: none;\r\n  }\r\n}\r\n</style>\r\n"]}]}